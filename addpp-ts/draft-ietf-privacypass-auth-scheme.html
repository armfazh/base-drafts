<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The Privacy Pass HTTP Authentication Scheme</title>
<meta content="Tommy Pauly" name="author">
<meta content="Steven Valdez" name="author">
<meta content="Christopher A. Wood" name="author">
<meta content="
       This document defines an HTTP authentication scheme for Privacy Pass,
a privacy-preserving authentication mechanism used for authorization.
The authentication scheme in this document can be used by clients
to redeem Privacy Pass tokens with an origin. It can also be used by
origins to challenge clients to present Privacy Pass tokens. 
    " name="description">
<meta content="xml2rfc 3.18.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-privacypass-auth-scheme-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.18.0
    Python 3.11.4
    ConfigArgParse 1.5.3
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.3
    platformdirs 3.10.0
    pycountry 22.3.5
    PyYAML 6.0
    requests 2.31.0
    setuptools 67.7.2
    six 1.16.0
    wcwidth 0.2.6
-->
<link href="draft-ietf-privacypass-auth-scheme.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Give the table caption label the same styling as the figcaption */

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Privacy Pass Authentication</td>
<td class="right">August 2023</td>
</tr></thead>
<tfoot><tr>
<td class="left">Pauly, et al.</td>
<td class="center">Expires 3 March 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-privacypass-auth-scheme-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2023-08-31" class="published">31 August 2023</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-03-03">3 March 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Pauly</div>
<div class="org">Apple Inc.</div>
</div>
<div class="author">
      <div class="author-name">S. Valdez</div>
<div class="org">Google LLC</div>
</div>
<div class="author">
      <div class="author-name">C. A. Wood</div>
<div class="org">Cloudflare</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The Privacy Pass HTTP Authentication Scheme</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines an HTTP authentication scheme for Privacy Pass,
a privacy-preserving authentication mechanism used for authorization.
The authentication scheme in this document can be used by clients
to redeem Privacy Pass tokens with an origin. It can also be used by
origins to challenge clients to present Privacy Pass tokens.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 3 March 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2023 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-http-authentication-scheme" class="internal xref">HTTP Authentication Scheme</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-token-challenge" class="internal xref">Token Challenge</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1" class="keepWithNext"><a href="#section-2.1.1" class="auto internal xref">2.1.1</a>.  <a href="#name-redemption-context-construc" class="internal xref">Redemption Context Construction</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.2">
                    <p id="section-toc.1-1.2.2.1.2.2.1"><a href="#section-2.1.2" class="auto internal xref">2.1.2</a>.  <a href="#name-token-caching" class="internal xref">Token Caching</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-token-redemption" class="internal xref">Token Redemption</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="auto internal xref">2.2.1</a>.  <a href="#name-token-verification" class="internal xref">Token Verification</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-user-interaction" class="internal xref">User Interaction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-authentication-scheme" class="internal xref">Authentication Scheme</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-token-type-registry" class="internal xref">Token Type Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-test-vectors" class="internal xref">Test Vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-challenge-and-redemption-st" class="internal xref">Challenge and Redemption Structure Test Vectors</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-http-header-test-vectors" class="internal xref">HTTP Header Test Vectors</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Privacy Pass tokens are unlinkable, one-time-use authenticators that can be used to
anonymously authorize a client (see
<span>[<a href="#ARCHITECTURE" class="cite xref">ARCHITECTURE</a>]</span>).
Tokens are generated by token issuers, on the basis of authentication,
attestation, or some previous action such as solving a CAPTCHA. A client
possessing such a token is able to prove that it was able to get a token
issued, without allowing the relying party redeeming the client's token
(the origin) to link it with the issuance flow.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Different types of authenticators, using different token issuance protocols,
can be used as Privacy Pass tokens.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document defines a common HTTP authentication scheme
(<span>[<a href="#RFC9110" class="cite xref">RFC9110</a>], <a href="https://rfc-editor.org/rfc/rfc9110#section-11" class="relref">Section 11</a></span>), PrivateToken, that allows clients to redeem various
kinds of Privacy Pass tokens.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Clients and relying parties (origins) interact using this scheme to perform the
token challenge and token redemption flow. In particular, origins challenge
clients for a token with an HTTP Authentication challenge (using the
WWW-Authenticate response header field). Clients then respond to that challenge
with an HTTP authentication response (using the Authorization request header
field). Clients produce an authentication response based on the origin's token
challenge by running the token issuance protocol
<span>[<a href="#ISSUANCE" class="cite xref">ISSUANCE</a>]</span>. The act of presenting a token in an
Authorization request header is referred to as token redemption. This
interaction between client and origin is shown below.<a href="#section-1-4" class="pilcrow">¶</a></p>
<span id="name-challenge-response-redempti"></span><div id="fig-overview">
<figure id="figure-1">
        <div id="section-1-5.1">
          <div class="alignLeft art-svg artwork" id="section-1-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="160" width="568" viewBox="0 0 568 160" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
              <path d="M 40,64 L 40,112" fill="none" stroke="black"></path>
              <path d="M 80,32 L 80,64" fill="none" stroke="black"></path>
              <path d="M 328,32 L 328,64" fill="none" stroke="black"></path>
              <path d="M 360,64 L 360,144" fill="none" stroke="black"></path>
              <path d="M 400,32 L 400,64" fill="none" stroke="black"></path>
              <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
              <path d="M 328,32 L 400,32" fill="none" stroke="black"></path>
              <path d="M 8,64 L 80,64" fill="none" stroke="black"></path>
              <path d="M 328,64 L 400,64" fill="none" stroke="black"></path>
              <path d="M 40,96 L 56,96" fill="none" stroke="black"></path>
              <path d="M 336,96 L 352,96" fill="none" stroke="black"></path>
              <path d="M 40,128 L 96,128" fill="none" stroke="black"></path>
              <path d="M 280,128 L 360,128" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="360,96 348,90.4 348,101.6" fill="black" transform="rotate(0,352,96)"></polygon>
              <polygon class="arrowhead" points="48,128 36,122.4 36,133.6" fill="black" transform="rotate(180,40,128)"></polygon>
              <g class="text">
                <text x="44" y="52">Origin</text>
                <text x="364" y="52">Client</text>
                <text x="136" y="100">WWW-Authenticate:</text>
                <text x="268" y="100">TokenChallenge</text>
                <text x="380" y="116">//</text>
                <text x="408" y="116">Run</text>
                <text x="460" y="116">issuance</text>
                <text x="532" y="116">protocol</text>
                <text x="164" y="132">Authorization:</text>
                <text x="248" y="132">Token</text>
                <text x="40" y="148">|</text>
              </g>
            </svg><a href="#section-1-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-challenge-response-redempti" class="selfRef">Challenge-response redemption protocol flow</a>
        </figcaption></figure>
</div>
<p id="section-1-6">In addition to working with different token issuance protocols, this scheme
optionally supports use of tokens that are associated with origin-chosen
contexts and specific origin names. Relying parties that request and redeem
tokens can choose a specific kind of token, as appropriate for its use case.
These options allow for different deployment models to prevent double-spending,
and allow for both interactive (online challenges) and non-interactive
(pre-fetched) tokens.<a href="#section-1-6" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Unless otherwise specified, this document encodes protocol messages in TLS
notation from <span>[<a href="#TLS13" class="cite xref">TLS13</a>]</span>, Section 3.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">This document uses the terms "Client", "Origin", "Issuer", "Issuance Protocol",
and "Token" as defined in <span>[<a href="#ARCHITECTURE" class="cite xref">ARCHITECTURE</a>]</span>. It additionally
uses the following terms in more specific ways:<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-4.1">Issuer key: Keying material that can be used with an issuance protocol
to create a signed token.<a href="#section-1.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.2">Token challenge: A requirement for tokens sent from an origin to a client,
using the "WWW-Authenticate" HTTP header field. This challenge is bound to a
specific token issuer and issuance protocol, and may be additionally bound to
a specific context or origin name.<a href="#section-1.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.3">Token redemption: An action by which a client presents a token to an origin
in an HTTP request, using the "Authorization" HTTP header field.<a href="#section-1.1-4.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="challenge-redemption">
<section id="section-2">
      <h2 id="name-http-authentication-scheme">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-http-authentication-scheme" class="section-name selfRef">HTTP Authentication Scheme</a>
      </h2>
<p id="section-2-1">Token redemption is performed using HTTP Authentication
(<span>[<a href="#RFC9110" class="cite xref">RFC9110</a>], <a href="https://rfc-editor.org/rfc/rfc9110#section-11" class="relref">Section 11</a></span>), with the scheme "PrivateToken". Origins challenge
clients to present a token from a specific issuer (<a href="#challenge" class="auto internal xref">Section 2.1</a>). Once a
client has received a token from that issuer, or already has a valid token
available, it presents the token to the origin (<a href="#redemption" class="auto internal xref">Section 2.2</a>).<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Unlike many authentication schemes in which a client will present the same
credentials across multiple requests, tokens used with the "PrivateToken"
scheme are single-use credentials, and are not reused. Spending the same token
value more than once allows the origin to link multiple transactions to the
same client. In deployment scenarios where origins send token challenges to
request tokens, origins ought to expect at most one request containing a token
from the client in reaction to a particular challenge.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The rest of this section describes the token challenge and redemption interactions
in more detail.<a href="#section-2-3" class="pilcrow">¶</a></p>
<div id="challenge">
<section id="section-2.1">
        <h3 id="name-token-challenge">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-token-challenge" class="section-name selfRef">Token Challenge</a>
        </h3>
<p id="section-2.1-1">Origins send a token challenge to clients in an "WWW-Authenticate" header field
with the "PrivateToken" scheme. This challenge includes a TokenChallenge
message, along with information about what keys to use when requesting a token
from the issuer.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">Origins that support this authentication scheme need to handle the following
tasks:<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.1-3">
<li id="section-2.1-3.1">Select which issuer to use, and configure the issuer name and token-key to
include in WWW-Authenticate challenges.<a href="#section-2.1-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-3.2">Determine a redemption context construction to include in the
TokenChallenge, as discussed in <a href="#context-construction" class="auto internal xref">Section 2.1.1</a>.<a href="#section-2.1-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-3.3">Select the origin information to include in the TokenChallenge. This can
be empty to allow fully cross-origin tokens, a single origin name that
matches the origin itself, or a list of origin names containing the origin
itself.<a href="#section-2.1-3.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-2.1-4">All token challenges MUST begin with a 2-octet integer that defines the
token type, in network byte order. This type indicates the issuance protocol
used to generate the token and determines the structure and semantics of the rest of
the structure. Values are registered in an IANA registry, <a href="#token-types" class="auto internal xref">Section 5.2</a>. Client MUST
ignore challenges with token_types they do not support.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5">This document defines the default challenge structure that can be used across
token types, although future token types MAY extend or modify the structure
of the challenge; see <a href="#token-types" class="auto internal xref">Section 5.2</a> for the registry information
which establishes and defines the relationship between "token_type" and the
contents of the TokenChallenge message.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1-6">Even when a given token type uses the default challenge, structure,
the requirements on the presence or interpretation of the fields can differ
across token types. For example, some token types might require that "origin_info"
is non-empty, while others allow it to be empty.<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<p id="section-2.1-7">The default TokenChallenge message has the following structure:<a href="#section-2.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1-8">
<pre>
struct {
    uint16_t token_type;
    opaque issuer_name&lt;1..2^16-1&gt;;
    opaque redemption_context&lt;0..32&gt;;
    opaque origin_info&lt;0..2^16-1&gt;;
} TokenChallenge;
</pre><a href="#section-2.1-8" class="pilcrow">¶</a>
</div>
<p id="section-2.1-9">The structure fields are defined as follows:<a href="#section-2.1-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-10.1">"token_type" is a 2-octet integer, in network byte order, as described
above.<a href="#section-2.1-10.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-10.2">"issuer_name" is an ASCII string that identifies the issuer using the format of the authority portion of a URI
as defined in <span><a href="https://rfc-editor.org/rfc/rfc3986#section-3.2" class="relref">Section 3.2</a> of [<a href="#URI" class="cite xref">URI</a>]</span>. This name identifies the issuer that is allowed to
issue tokens that can be redeemed by this origin. The field that stores this string in the challenge
is prefixed with a 2-octet integer indicating the length, in network byte order.<a href="#section-2.1-10.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-10.3">"redemption_context" is a field that is either 0 or 32 bytes, prefixed with a single
octet indicating the length (either 0 or 32). If value is non-empty, it is a 32-byte value
generated by the origin that allows the origin to require that clients fetch tokens
bound to a specific context, as opposed to reusing tokens that were fetched for other
contexts. See <a href="#context-construction" class="auto internal xref">Section 2.1.1</a> for example contexts that might be useful in
practice. Challenges with redemption_context values of invalid lengths MUST be ignored.<a href="#section-2.1-10.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-10.4">"origin_info" is an ASCII string that is either empty, or contains one or more
origin names that allow a token to be scoped to a specific set of origins. Each
origin name uses the format of the authority portion of a URI as defined in
<span><a href="https://rfc-editor.org/rfc/rfc3986#section-3.2" class="relref">Section 3.2</a> of [<a href="#URI" class="cite xref">URI</a>]</span>. The string is prefixed with a 2-octet integer indicating
the length, in network byte order. If empty, any non-origin-specific token can be
redeemed. If the string contains multiple origin names, they are delimited with
commas "," without any whitespace. If this field is not empty, the Origin MUST
include its own name as one of the names in the list.<a href="#section-2.1-10.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.1-11">When used in an authentication challenge, the "PrivateToken" scheme uses the
following parameters:<a href="#section-2.1-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-12.1">"challenge", which contains a base64url-encoded <span>[<a href="#RFC4648" class="cite xref">RFC4648</a>]</span> TokenChallenge
value. This document follows the default padding behavior described in
<span><a href="https://rfc-editor.org/rfc/rfc4648#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC4648" class="cite xref">RFC4648</a>]</span>, so the base64url value MUST include padding.
As an Authentication Parameter (<code>auth-param</code> from <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>], <a href="https://rfc-editor.org/rfc/rfc9110#section-11.2" class="relref">Section 11.2</a></span>),
the value can be either a token or a quoted-string, and might be required to
be a quoted-string if the base64url string includes "=" characters. This
challenge value MUST be unique for every 401 HTTP response to prevent replay
attacks. This parameter is required for all challenges.<a href="#section-2.1-12.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-12.2">"token-key", which contains a base64url encoding of the public key for
use with the issuance protocol indicated by the challenge. See <span>[<a href="#ISSUANCE" class="cite xref">ISSUANCE</a>]</span>
for more information about how this public key is used by the issuance protocols
in that specification. The encoding of
the public key is determined by the token type; see <a href="#token-types" class="auto internal xref">Section 5.2</a>.
As with "challenge", the base64url value MUST include padding. As an
Authentication Parameter (<code>auth-param</code> from <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>], <a href="https://rfc-editor.org/rfc/rfc9110#section-11.2" class="relref">Section 11.2</a></span>), the
value can be either a token or a quoted-string, and might be required to be a
quoted-string if the base64url string includes "=" characters. This parameter
MAY be omitted in deployments where clients are able to retrieve the issuer key
using an out-of-band mechanism.<a href="#section-2.1-12.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-12.3">"max-age", an optional parameter that consists of the number of seconds for
which the challenge will be accepted by the origin.<a href="#section-2.1-12.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.1-13">Clients MAY ignore the challenge, e.g., because the token-key is
invalid or otherwise untrusted.<a href="#section-2.1-13" class="pilcrow">¶</a></p>
<p id="section-2.1-14">The header field MAY also include the standard "realm" parameter, if desired.
Issuance protocols MAY require other parameters. Clients SHOULD ignore unknown
parameters in challenges, except if otherwise specified by issuance protocols.<a href="#section-2.1-14" class="pilcrow">¶</a></p>
<p id="section-2.1-15">As an example, the WWW-Authenticate header field could look like this:<a href="#section-2.1-15" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1-16">
<pre>
WWW-Authenticate:
  PrivateToken challenge="abc...", token-key="123..."
</pre><a href="#section-2.1-16" class="pilcrow">¶</a>
</div>
<p id="section-2.1-17">Upon receipt of this challenge, a client validates the TokenChallenge before
responding to it. Validation requirements are as follows:<a href="#section-2.1-17" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-18.1">The token_type is recognized and supported by the client;<a href="#section-2.1-18.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-18.2">The TokenChallenge structure is well-formed; and<a href="#section-2.1-18.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-18.3">If the origin_info field is non-empty, the name of the origin that issued the
authentication challenge is included in the list of origin names. Comparison
of the origin name that issued the authentication challenge against elements
in the origin_info list is done via case-insensitive equality checks.<a href="#section-2.1-18.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.1-19">If validation fails, the client MUST NOT process or respond to the
challenge. Clients MAY have further restrictions and requirements around
validating when a challenge is considered acceptable or valid. For example,
clients can choose to ignore challenges that list origin names for which
current connection is not authoritative (according to the TLS certificate).<a href="#section-2.1-19" class="pilcrow">¶</a></p>
<p id="section-2.1-20">Caching and pre-fetching of tokens is discussed in <a href="#caching" class="auto internal xref">Section 2.1.2</a>.<a href="#section-2.1-20" class="pilcrow">¶</a></p>
<p id="section-2.1-21">Note that it is possible for the WWW-Authenticate header field to include
multiple challenges (<span>[<a href="#RFC9110" class="cite xref">RFC9110</a>], <a href="https://rfc-editor.org/rfc/rfc9110#section-11.6.1" class="relref">Section 11.6.1</a></span>). This allows the origin to indicate support for different
token types, issuers, or to include multiple redemption contexts. For example,
the WWW-Authenticate header field could look like this:<a href="#section-2.1-21" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1-22">
<pre>
WWW-Authenticate:
  PrivateToken challenge="abc...", token-key="123...",
  PrivateToken challenge="def...", token-key="234..."
</pre><a href="#section-2.1-22" class="pilcrow">¶</a>
</div>
<p id="section-2.1-23">Origins should only include challenges for different types of issuance
protocols with functionally equivalent properties. For instance, both issuance
protocols in <span>[<a href="#ISSUANCE" class="cite xref">ISSUANCE</a>]</span> have the same functional properties, albeit with
different mechanisms for verifying the resulting tokens during redemption.
Since clients are free to choose which challenge they want to consume when
presented with options, mixing multiple challenges with different functional
properties for one use case is nonsensical. If the origin has a preference
for one challenge over another (for example, if one uses a token type
that is faster to verify), it can sort it to be first in the list
of challenges as a hint to the client.<a href="#section-2.1-23" class="pilcrow">¶</a></p>
<div id="context-construction">
<section id="section-2.1.1">
          <h4 id="name-redemption-context-construc">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-redemption-context-construc" class="section-name selfRef">Redemption Context Construction</a>
          </h4>
<p id="section-2.1.1-1">The TokenChallenge redemption context allows the origin to determine the
context in which a given token can be redeemed. This value can be a unique
per-request nonce, constructed from 32 freshly generated random bytes. It
can also represent state or properties of the client session. Some example
properties and methods for constructing the corresponding context are below.
This list is not exhaustive.<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1.1-2.1">Context bound to a given time window: Construct redemption context as
F(current time window), where F is a pseudorandom function.<a href="#section-2.1.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.1.1-2.2">Context bound to a client network: Construct redemption context as
F(client ASN), where F is a pseudorandom function.<a href="#section-2.1.1-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.1.1-2.3">Context bound to a given time window and client network: Construct redemption
context as F(current time window, client ASN), where F is a pseudorandom function.<a href="#section-2.1.1-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-2.1.1-3">An empty redemption context is not bound to any property of the client session.
Preventing double spending on tokens requires the origin to keep state
associated with the redemption context. The size of this state varies based on
the size of the redemption context. For example, double spend state for unique,
per-request redemption contexts only needs to exist within the scope of
the request connection or session. In contrast, double spend state for empty
redemption contexts must be stored and shared across all requests until
token-key expiration or rotation.<a href="#section-2.1.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1.1-4">Origins that share redemption contexts, i.e., by using the same redemption
context, choosing the same issuer, and providing the same origin_info field in
the TokenChallenge, must necessarily share state required to enforce double
spend prevention. Origins should consider the operational complexity of this
shared state before choosing to share redemption contexts. Failure to
successfully synchronize this state and use it for double spend prevention can
allow Clients to redeem tokens to one Origin that were issued after an
interaction with another Origin that shares the context.<a href="#section-2.1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="caching">
<section id="section-2.1.2">
          <h4 id="name-token-caching">
<a href="#section-2.1.2" class="section-number selfRef">2.1.2. </a><a href="#name-token-caching" class="section-name selfRef">Token Caching</a>
          </h4>
<p id="section-2.1.2-1">Clients can generate multiple tokens from a single TokenChallenge, and cache
them for future use. This improves privacy by separating the time of token
issuance from the time of token redemption, and also allows clients to avoid
any overhead of receiving new tokens via the issuance protocol.<a href="#section-2.1.2-1" class="pilcrow">¶</a></p>
<p id="section-2.1.2-2">Cached tokens can only be redeemed when they match all of the fields in the
TokenChallenge: token_type, issuer_name, redemption_context, and origin_info.
Clients ought to store cached tokens based on all of these fields, to
avoid trying to redeem a token that does not match. Note that each token
has a unique client nonce, which is sent in token redemption (<a href="#redemption" class="auto internal xref">Section 2.2</a>).<a href="#section-2.1.2-2" class="pilcrow">¶</a></p>
<p id="section-2.1.2-3">If a client fetches a batch of multiple tokens for future use that are bound
to a specific redemption context (the redemption_context in the TokenChallenge
was not empty), clients SHOULD discard these tokens upon flushing state such as
HTTP cookies <span>[<a href="#COOKIES" class="cite xref">COOKIES</a>]</span>, or changing networks.
Using these tokens in a context that otherwise would not be linkable to the
original context could allow the origin to recognize a client.<a href="#section-2.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="redemption">
<section id="section-2.2">
        <h3 id="name-token-redemption">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-token-redemption" class="section-name selfRef">Token Redemption</a>
        </h3>
<p id="section-2.2-1">The output of the issuance protocol is a token that corresponds to the origin's
challenge (see <a href="#challenge" class="auto internal xref">Section 2.1</a>). A token is a structure that begins with a
two-octet field that indicates a token type, which MUST match the token_type in
the TokenChallenge structure. This value determines the structure and semantics
of the rest of token structure.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">This document defines the default token structure that can be used across
token types, although future token types MAY extend or modify the structure
of the token; see <a href="#token-types" class="auto internal xref">Section 5.2</a> for the registry information which
establishes and defines the relationship between "token_type" and the contents
of the Token structure.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">The default Token message has the following structure:<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2-4">
<pre>
struct {
    uint16_t token_type;
    uint8_t nonce[32];
    uint8_t challenge_digest[32];
    uint8_t token_key_id[Nid];
    uint8_t authenticator[Nk];
} Token;
</pre><a href="#section-2.2-4" class="pilcrow">¶</a>
</div>
<p id="section-2.2-5">The structure fields are defined as follows:<a href="#section-2.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-6.1">"token_type" is a 2-octet integer, in network byte order, as described
above.<a href="#section-2.2-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-6.2">"nonce" is a 32-octet value containing a client-generated random nonce.<a href="#section-2.2-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-6.3">"challenge_digest" is a 32-octet value containing the hash of the
original TokenChallenge, SHA-256(TokenChallenge), where SHA-256 is as defined
in <span>[<a href="#SHS" class="cite xref">SHS</a>]</span>. Changing the hash function to something
other than SHA-256 would require defining a new token type and token structure
(since the contents of challenge_digest would be computed differently),
which can be done in a future specification.<a href="#section-2.2-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-6.4">"token_key_id" is a Nid-octet identifier for the token authentication
key. The value of this field is defined by the token_type and corresponding
issuance protocol.<a href="#section-2.2-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-6.5">"authenticator" is a Nk-octet authenticator that is cryptographically bound
to the preceding fields in the token; see <a href="#verification" class="auto internal xref">Section 2.2.1</a> for more information
about how this field is used in verifying a token. The token_type and corresponding
issuance protocol determine the value of the authenticator field and how it is computed.
The value of constant Nk depends on token_type, as defined in <a href="#token-types" class="auto internal xref">Section 5.2</a>.<a href="#section-2.2-6.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.2-7">The authenticator value in the Token structure is computed over the token_type,
nonce, challenge_digest, and token_key_id fields. A token is considered a valid
if token verification using succeeds; see <a href="#verification" class="auto internal xref">Section 2.2.1</a> for details about
verifying the token and its authenticator value.<a href="#section-2.2-7" class="pilcrow">¶</a></p>
<p id="section-2.2-8">When used for client authorization, the "PrivateToken" authentication
scheme defines one parameter, "token", which contains the base64url-encoded
Token struct. As with the challenge parameters (<a href="#challenge" class="auto internal xref">Section 2.1</a>), the base64url
value MUST include padding. As an Authentication Parameter (<code>auth-param</code> from
<span>[<a href="#RFC9110" class="cite xref">RFC9110</a>], <a href="https://rfc-editor.org/rfc/rfc9110#section-11.2" class="relref">Section 11.2</a></span>), the value can be either a token or a
quoted-string, and might be required to be a quoted-string if the base64url
string includes "=" characters. All unknown or unsupported parameters to
"PrivateToken" authentication credentials MUST be ignored.<a href="#section-2.2-8" class="pilcrow">¶</a></p>
<p id="section-2.2-9">Clients present this Token structure to origins in a new HTTP request using
the Authorization header field as follows:<a href="#section-2.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2-10">
<pre>
Authorization: PrivateToken token="abc..."
</pre><a href="#section-2.2-10" class="pilcrow">¶</a>
</div>
<p id="section-2.2-11">For context-bound tokens, origins store or reconstruct the contexts of previous
TokenChallenge structures in order to validate the token. A TokenChallenge can
be bound to a specific TLS session with a client, but origins can also accept
tokens for valid challenges in new sessions. Origins SHOULD implement some form
of double-spend prevention that prevents a token with the same nonce from being
redeemed twice. Double-spend prevention ensures that clients cannot replay tokens
for previous challenges. For context-bound tokens, this double-spend prevention
can require no state or minimal state, since the context can be used to verify
token uniqueness.<a href="#section-2.2-11" class="pilcrow">¶</a></p>
<p id="section-2.2-12">If a client is unable to fetch a token, it MUST react to the challenge as
if it could not produce a valid Authorization response.<a href="#section-2.2-12" class="pilcrow">¶</a></p>
<div id="verification">
<section id="section-2.2.1">
          <h4 id="name-token-verification">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-token-verification" class="section-name selfRef">Token Verification</a>
          </h4>
<p id="section-2.2.1-1">A token consists of some input cryptographically bound to an authenticator
value, such as a digital signature. Verifying a token consists of checking that
the authenticator value is correct.<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.2.1-2">The authenticator value is as computed when running and finalizing the issuance
protocol corresponding to the token type with the following value as the input:<a href="#section-2.2.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.2.1-3">
<pre>
struct {
    uint16_t token_type;
    uint8_t nonce[32];
    uint8_t challenge_digest[32];
    uint8_t token_key_id[Nid];
} AuthenticatorInput;
</pre><a href="#section-2.2.1-3" class="pilcrow">¶</a>
</div>
<p id="section-2.2.1-4">The value of these fields are as described in <a href="#redemption" class="auto internal xref">Section 2.2</a>. The cryptographic
verification check depends on the token type; see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-privacypass-protocol-12#section-5.4" class="relref">Section 5.4</a> of [<a href="#ISSUANCE" class="cite xref">ISSUANCE</a>]</span>
and <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-privacypass-protocol-12#section-6.4" class="relref">Section 6.4</a> of [<a href="#ISSUANCE" class="cite xref">ISSUANCE</a>]</span> for verification instructions for the issuance
protocols described in <span>[<a href="#ISSUANCE" class="cite xref">ISSUANCE</a>]</span>. As such, the security properties of the
token, e.g., the probability that one can forge an authenticator value without
invoking the issuance protocol, depend on the cryptographic algorithm used by
the issuance protocol as determined by the token type.<a href="#section-2.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="interaction">
<section id="section-3">
      <h2 id="name-user-interaction">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-user-interaction" class="section-name selfRef">User Interaction</a>
      </h2>
<p id="section-3-1">When used in contexts like websites, origins that challenge clients for
tokens need to consider how to optimize their interaction model to ensure a
good user experience.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Origins SHOULD minimize the number of challenges sent on a particular client
session, such as a unique TLS session between a client and origin
(referred to as the "redemption context" in <span>[<a href="#ARCHITECTURE" class="cite xref">ARCHITECTURE</a>]</span>). Similarly, clients
SHOULD have some implementation-specific policy to minimize the number of tokens
that can be retrieved by origins. One possible implementation of this policy is
to bound the number of token challenges a given origin can provide for a given
session.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">Token challenges can be performed without explicit user involvement, depending
on the issuance protocol. If tokens are scoped to a specific origin,
there is no need for per-challenge user interaction. Note that the issuance
protocol may separately involve user interaction if the client needs to be
newly validated.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">If a client cannot use cached tokens to respond to a challenge, either because
it has run out of cached tokens or the associated context is unique, the token
issuance process can add user-perceivable latency. Origins need not block
useful work such as loading the contents of a web page on token authentication.
Instead, token authentication can be used in similar ways to existing CAPTCHA
validation flows, wherein validation sometimes proceeds alongside useful work,
e.g., when loading contents of a web page, but without the need for user interaction.
If issuance is taking a long time, an origin can fall back to another method
of user validation.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">An origin MUST NOT use more than one redemption context value for a given token
type and issuer per client request. If an origin issues a large number of
challenges with unique contexts, such as more than once for each request, this
can indicate that the origin is either not functioning correctly or is trying
to attack or overload the client or issuance server. In such cases, a client
MUST ignore redundant token challenges for the same request and SHOULD alert
the user if possible.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">Origins MAY include multiple challenges, where each challenge refers to a
different issuer or a different token type, to allow clients to choose a
preferred issuer or type.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">An origin MUST NOT assume that token challenges will always yield a valid
token. Clients might experience issues running the issuance protocol, e.g.,
because the attester or issuer is unavailable, or clients might simply not
support the requested token type. Origins SHOULD account for such operational
or interoperability failures by offering clients a fallback challenge such
as CAPTCHA for accessing a resource. Failure to provide a fallback will likely
mean that some clients fail authentication and cannot perform the desired
action, such as loading a web page or accessing some other resource.<a href="#section-3-7" class="pilcrow">¶</a></p>
<p id="section-3-8">For example, consider a scenario in which the client is a web browser, and the
origin can accept either a token or a solution to a puzzle intended to
determine if the client is a real human user. The origin would send clients a
401 HTTP response that contains a token challenge in a "WWW-Authenticate"
header field along with content that contains the puzzle to display to the
user. Clients that are able to respond with a token will be able to
automatically return the token and not show the puzzle, while clients that
either do not support tokens or are unable to fetch tokens at a particular
time can present the user with the puzzle.<a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9">To mitigate the risk of deployments becoming dependent on tokens, clients and
origins SHOULD grease their behavior unless explicitly configured not to. In
particular, clients SHOULD ignore token challenges with some non-zero
probability. From the origin's perspective, ignoring a token challenge is
indistinguishable from the issuance protocol failing for arbitrary reasons
(excluding what can be inferred from latency between the client and origin interaction).
Likewise, origins SHOULD randomly choose to not challenge clients for tokens
with some non-zero probability. Moreover, origins SHOULD include random token
types, from the Reserved list of "greased" types (defined in <a href="#token-types" class="auto internal xref">Section 5.2</a>),
with some non-zero probability.<a href="#section-3-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-considerations">
<section id="section-4">
      <h2 id="name-security-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-4-1">The security properties of token challenges vary depending on whether the
challenge contains a redemption context or not, as well as whether the
challenge is per-origin or not. For example, cross-origin tokens with empty
contexts can be replayed from one party by another, as shown below.<a href="#section-4-1" class="pilcrow">¶</a></p>
<span id="name-replay-attack-example"></span><div id="fig-replay">
<figure id="figure-2">
        <div id="section-4-2.1">
          <div class="alignLeft art-svg artwork" id="section-4-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="160" width="624" viewBox="0 0 624 160" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 8,32 L 8,64" fill="none" stroke="black"></path>
              <path d="M 40,64 L 40,128" fill="none" stroke="black"></path>
              <path d="M 80,32 L 80,64" fill="none" stroke="black"></path>
              <path d="M 312,32 L 312,64" fill="none" stroke="black"></path>
              <path d="M 360,64 L 360,112" fill="none" stroke="black"></path>
              <path d="M 400,32 L 400,64" fill="none" stroke="black"></path>
              <path d="M 544,32 L 544,64" fill="none" stroke="black"></path>
              <path d="M 576,64 L 576,96" fill="none" stroke="black"></path>
              <path d="M 616,32 L 616,64" fill="none" stroke="black"></path>
              <path d="M 8,32 L 80,32" fill="none" stroke="black"></path>
              <path d="M 312,32 L 400,32" fill="none" stroke="black"></path>
              <path d="M 544,32 L 616,32" fill="none" stroke="black"></path>
              <path d="M 8,64 L 80,64" fill="none" stroke="black"></path>
              <path d="M 312,64 L 400,64" fill="none" stroke="black"></path>
              <path d="M 544,64 L 616,64" fill="none" stroke="black"></path>
              <path d="M 40,96 L 56,96" fill="none" stroke="black"></path>
              <path d="M 336,96 L 352,96" fill="none" stroke="black"></path>
              <path d="M 360,112 L 384,112" fill="none" stroke="black"></path>
              <path d="M 552,112 L 576,112" fill="none" stroke="black"></path>
              <path d="M 360,128 L 376,128" fill="none" stroke="black"></path>
              <path d="M 560,128 L 576,128" fill="none" stroke="black"></path>
              <path d="M 40,144 L 128,144" fill="none" stroke="black"></path>
              <path d="M 264,144 L 360,144" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="584,112 572,106.4 572,117.6" fill="black" transform="rotate(0,576,112)"></polygon>
              <polygon class="arrowhead" points="368,128 356,122.4 356,133.6" fill="black" transform="rotate(180,360,128)"></polygon>
              <polygon class="arrowhead" points="360,96 348,90.4 348,101.6" fill="black" transform="rotate(0,352,96)"></polygon>
              <polygon class="arrowhead" points="48,144 36,138.4 36,149.6" fill="black" transform="rotate(180,40,144)"></polygon>
              <g class="text">
                <text x="44" y="52">Origin</text>
                <text x="356" y="52">Attacker</text>
                <text x="580" y="52">Client</text>
                <text x="136" y="100">WWW-Authenticate:</text>
                <text x="268" y="100">TokenChallenge</text>
                <text x="424" y="116">(replay</text>
                <text x="500" y="116">challenge)</text>
                <text x="444" y="132">Authorization:</text>
                <text x="528" y="132">Token</text>
                <text x="168" y="148">(replay</text>
                <text x="228" y="148">token)</text>
              </g>
            </svg><a href="#section-4-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-replay-attack-example" class="selfRef">Replay attack example</a>
        </figcaption></figure>
</div>
<p id="section-4-3">Moreover, when a Client holds cross-origin tokens with empty contexts, it
is possible for any Origin in the cross-origin set to deplete that Client
set of tokens. To prevent this from happening, tokens can be scoped to single
Origins (with non-empty origin_info) such that they can only be redeemed for
a single Origin. Alternatively, if tokens are cross-Origin, Clients can use
alternate methods to prevent many tokens from being redeemed at once. For
example, if the Origin requests an excess of tokens, the Client could choose to
not present any tokens for verification if a redemption had already
occurred in a given time window.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">Token challenges that include non-empty origin_info bind tokens to one or more
specific origins. As described in <a href="#challenge" class="auto internal xref">Section 2.1</a>, clients only accept such
challenges from origin names listed in the origin_info string. Even if multiple
origins are listed, a token can only be redeemed for an origin if the challenge
has a match for the origin_info. For example, if "a.example.com" issues
a challenge with an origin_info string of "a.example.com,b.example.com", a
client could redeem a token fetched for this challenge if and only if
"b.example.com" also included an origin_info string of
"a.example.com,b.example.com". On the other hand, if "b.example.com" had an
origin_info string of "b.example.com" or "b.example.com,a.example.com" or
"a.example.com,b.example.com,c.example.com", the string would not match and the
client would need to use a different token.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">Context-bound token challenges require clients to obtain matching tokens when
challenged, rather than presenting a token that was obtained from a different
context in the past. This can make it more likely that issuance and redemption
events will occur at approximately the same time. For example, if a client is
challenged for a token with a unique context at time T1 and then subsequently
obtains a token at time T2, a colluding issuer and origin can link this to the
same client if T2 is unique to the client. This linkability is less feasible as
the number of issuance events at time T2 increases. Depending on the "max-age"
token challenge parameter, clients MAY try to augment the time between getting
challenged then redeeming a token so as to make this sort of linkability more
difficult. For more discussion on correlation risks between token issuance and
redemption, see <span>[<a href="#ARCHITECTURE" class="cite xref">ARCHITECTURE</a>]</span>.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">As discussed in <a href="#challenge" class="auto internal xref">Section 2.1</a>, clients SHOULD discard any context-bound tokens
upon flushing cookies or changing networks, to prevent an origin using the
redemption context state as a cookie to recognize clients.<a href="#section-4-6" class="pilcrow">¶</a></p>
<p id="section-4-7">Applications SHOULD constrain tokens to a single origin unless the use case can
accommodate such replay attacks. Replays are also possible if the client
redeems a token sent as part of 0-RTT data. If successful token redemption
produces side effects, origins SHOULD implement an anti-replay mechanism to
mitigate the harm of such replays. See <span>[<a href="#TLS13" class="cite xref">TLS13</a>], <a href="https://rfc-editor.org/rfc/rfc8446#section-8" class="relref">Section 8</a></span> and
<span>[<a href="#RFC9001" class="cite xref">RFC9001</a>], <a href="https://rfc-editor.org/rfc/rfc9001#section-9.2" class="relref">Section 9.2</a></span> for details about anti-replay mechanisms, as well as
<span>[<a href="#RFC8470" class="cite xref">RFC8470</a>], <a href="https://rfc-editor.org/rfc/rfc8470#section-3" class="relref">Section 3</a></span> for discussion about safety considerations for 0-RTT
HTTP data.<a href="#section-4-7" class="pilcrow">¶</a></p>
<p id="section-4-8">All random values in the challenge and token MUST be generated using a
cryptographically secure source of randomness.<a href="#section-4-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="authentication-scheme">
<section id="section-5.1">
        <h3 id="name-authentication-scheme">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-authentication-scheme" class="section-name selfRef">Authentication Scheme</a>
        </h3>
<p id="section-5.1-1">This document registers the "PrivateToken" authentication scheme in the
"Hypertext Transfer Protocol (HTTP) Authentication Scheme Registry" defined
in <span>[<a href="#RFC9110" class="cite xref">RFC9110</a>], <a href="https://rfc-editor.org/rfc/rfc9110#section-16.4" class="relref">Section 16.4</a></span>.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Authentication Scheme Name: PrivateToken<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">Pointer to specification text: <a href="#challenge-redemption" class="auto internal xref">Section 2</a> of this document<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="token-types">
<section id="section-5.2">
        <h3 id="name-token-type-registry">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-token-type-registry" class="section-name selfRef">Token Type Registry</a>
        </h3>
<p id="section-5.2-1">IANA is requested to create a new "Privacy Pass Token Type" registry in a new
"Privacy Pass Parameters" page to list identifiers for issuance protocols
defined for use with the Privacy Pass token authentication scheme. These
identifiers are two-byte values, so the maximum possible value is
0xFFFF = 65535.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Template:<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-3.1">Value: The two-byte identifier for the algorithm<a href="#section-5.2-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-3.2">Name: Name of the issuance protocol<a href="#section-5.2-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-3.3">Token Structure: The contents of the Token structure in <a href="#redemption" class="auto internal xref">Section 2.2</a><a href="#section-5.2-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-3.4">Token Key Encoding: The encoding of the "token-key" parameter in <a href="#redemption" class="auto internal xref">Section 2.2</a><a href="#section-5.2-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-3.5">TokenChallenge Structure: The contents of the TokenChallenge structure in <a href="#challenge" class="auto internal xref">Section 2.1</a><a href="#section-5.2-3.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-3.6">Publicly Verifiable: A Y/N value indicating if the output tokens are
publicly verifiable<a href="#section-5.2-3.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-3.7">Public Metadata: A Y/N value indicating if the output tokens can contain
public metadata.<a href="#section-5.2-3.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-3.8">Private Metadata: A Y/N value indicating if the output tokens can contain
private metadata.<a href="#section-5.2-3.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-3.9">Nk: The length in bytes of an output authenticator<a href="#section-5.2-3.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-3.10">Nid: The length of the token key identifier<a href="#section-5.2-3.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-3.11">Reference: Where this algorithm is defined<a href="#section-5.2-3.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-3.12">Notes: Any notes associated with the entry<a href="#section-5.2-3.12" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.2-4">New entries in this registry are subject to the Specification Required
registration policy (<span>[<a href="#RFC8126" class="cite xref">RFC8126</a>], <a href="https://rfc-editor.org/rfc/rfc8126#section-4.6" class="relref">Section 4.6</a></span>). Designated experts need to
ensure that the token type is sufficiently clearly defined to be used for both
token issuance and redemption, and meets the common security and privacy
requirements for issuance protocols defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-privacypass-architecture-14#section-3.2" class="relref">Section 3.2</a> of [<a href="#ARCHITECTURE" class="cite xref">ARCHITECTURE</a>]</span>.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">Values 0xFF00-0xFFFF are reserved for private use. Implementers can use values
in this range for experimentation with new token type protocols, as well as other
proprietary uses that do not require interoperability.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<p id="section-5.2-6">This document defines several Reserved values, which can be used by clients
and servers to send "greased" values in token challenges and responses to
ensure that implementations remain able to handle unknown token types
gracefully (this technique is inspired by <span>[<a href="#RFC8701" class="cite xref">RFC8701</a>]</span>). Implementations SHOULD
select reserved values at random when including them in greased messages.
Servers can include these in TokenChallenge structures, either as the only
challenge when no real token type is desired, or as one challenge in a list of
challenges that include real values. Clients can include these in Token
structures when they are not able to present a real token response. The
contents of the Token structure SHOULD be filled with random bytes when
using greased values.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2-7">The initial contents for this registry consist of the following Values.
For each Value, the Name is "RESERVED", the Publicly Verifiable, Public
Metadata, Private Metadata, Nk, and Nid attributes are all assigned "N/A",
the Reference is this document, and the Notes attribute is "None". The
initial list of Values is as follows:<a href="#section-5.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-8.1">0x0000<a href="#section-5.2-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-8.2">0x02AA<a href="#section-5.2-8.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-8.3">0x1132<a href="#section-5.2-8.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-8.4">0x2E96<a href="#section-5.2-8.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-8.5">0x3CD3<a href="#section-5.2-8.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-8.6">0x4473<a href="#section-5.2-8.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-8.7">0x5A63<a href="#section-5.2-8.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-8.8">0x6D32<a href="#section-5.2-8.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-8.9">0x7F3F<a href="#section-5.2-8.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-8.10">0x8D07<a href="#section-5.2-8.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-8.11">0x916B<a href="#section-5.2-8.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-8.12">0xA6A4<a href="#section-5.2-8.12" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-8.13">0xBEAB<a href="#section-5.2-8.13" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-8.14">0xC3F3<a href="#section-5.2-8.14" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-8.15">0xDA42<a href="#section-5.2-8.15" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-8.16">0xE944<a href="#section-5.2-8.16" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-8.17">0xF057<a href="#section-5.2-8.17" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.2-9">Additionally, the registry is to be initialized with the following entry
for Private Use.<a href="#section-5.2-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2-10.1">Value: 0xFF00-0xFFFF<a href="#section-5.2-10.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-10.2">Name: Private Use<a href="#section-5.2-10.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-10.3">Token Structure: The contents of the Token structure in <a href="#redemption" class="auto internal xref">Section 2.2</a><a href="#section-5.2-10.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-10.4">Token Key Encoding: N/A<a href="#section-5.2-10.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-10.5">TokenChallenge Structure: The contents of the TokenChallenge structure in <a href="#challenge" class="auto internal xref">Section 2.1</a><a href="#section-5.2-10.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-10.6">Publicly Verifiable: N/A<a href="#section-5.2-10.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-10.7">Public Metadata: N/A<a href="#section-5.2-10.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-10.8">Private Metadata: N/A<a href="#section-5.2-10.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-10.9">Nk: N/A<a href="#section-5.2-10.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-10.10">Nid: N/A<a href="#section-5.2-10.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-10.11">Reference: This document<a href="#section-5.2-10.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.2-10.12">Notes: None<a href="#section-5.2-10.12" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.2-11"><span>[<a href="#ISSUANCE" class="cite xref">ISSUANCE</a>]</span> defines other non-grease entries for this registry.<a href="#section-5.2-11" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-6">
      <h2 id="name-references">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-6.1">
        <h3 id="name-normative-references">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4648">https://www.rfc-editor.org/rfc/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9110">[RFC9110]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span>, <span class="refAuthor">Nottingham, M., Ed.</span>, and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"HTTP Semantics"</span>, <span class="seriesInfo">STD 97</span>, <span class="seriesInfo">RFC 9110</span>, <span class="seriesInfo">DOI 10.17487/RFC9110</span>, <time datetime="2022-06" class="refDate">June 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9110">https://www.rfc-editor.org/rfc/rfc9110</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHS">[SHS]</dt>
        <dd>
<span class="refAuthor">Dang, Q.</span>, <span class="refTitle">"Secure Hash Standard"</span>, <span class="refContent">National Institute of Standards and Technology</span>, <span class="seriesInfo">DOI 10.6028/nist.fips.180-4</span>, <time datetime="2015-07" class="refDate">July 2015</time>, <span>&lt;<a href="https://doi.org/10.6028/nist.fips.180-4">https://doi.org/10.6028/nist.fips.180-4</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TLS13">[TLS13]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="URI">[URI]</dt>
      <dd>
<span class="refAuthor">Berners-Lee, T.</span>, <span class="refAuthor">Fielding, R.</span>, and <span class="refAuthor">L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01" class="refDate">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3986">https://www.rfc-editor.org/rfc/rfc3986</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-6.2">
        <h3 id="name-informative-references">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="ARCHITECTURE">[ARCHITECTURE]</dt>
        <dd>
<span class="refAuthor">Davidson, A.</span>, <span class="refAuthor">Iyengar, J.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"The Privacy Pass Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-privacypass-architecture-14</span>, <time datetime="2023-08-09" class="refDate">9 August 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-privacypass-architecture-14">https://datatracker.ietf.org/doc/html/draft-ietf-privacypass-architecture-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="COOKIES">[COOKIES]</dt>
        <dd>
<span class="refAuthor">Bingler, S.</span>, <span class="refAuthor">West, M.</span>, and <span class="refAuthor">J. Wilander</span>, <span class="refTitle">"Cookies: HTTP State Management Mechanism"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-httpbis-rfc6265bis-12</span>, <time datetime="2023-05-10" class="refDate">10 May 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-rfc6265bis-12">https://datatracker.ietf.org/doc/html/draft-ietf-httpbis-rfc6265bis-12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ISSUANCE">[ISSUANCE]</dt>
        <dd>
<span class="refAuthor">Celi, S.</span>, <span class="refAuthor">Davidson, A.</span>, <span class="refAuthor">Valdez, S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Privacy Pass Issuance Protocol"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-privacypass-protocol-12</span>, <time datetime="2023-08-16" class="refDate">16 August 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-privacypass-protocol-12">https://datatracker.ietf.org/doc/html/draft-ietf-privacypass-protocol-12</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8470">[RFC8470]</dt>
        <dd>
<span class="refAuthor">Thomson, M.</span>, <span class="refAuthor">Nottingham, M.</span>, and <span class="refAuthor">W. Tarreau</span>, <span class="refTitle">"Using Early Data in HTTP"</span>, <span class="seriesInfo">RFC 8470</span>, <span class="seriesInfo">DOI 10.17487/RFC8470</span>, <time datetime="2018-09" class="refDate">September 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8470">https://www.rfc-editor.org/rfc/rfc8470</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8701">[RFC8701]</dt>
        <dd>
<span class="refAuthor">Benjamin, D.</span>, <span class="refTitle">"Applying Generate Random Extensions And Sustain Extensibility (GREASE) to TLS Extensibility"</span>, <span class="seriesInfo">RFC 8701</span>, <span class="seriesInfo">DOI 10.17487/RFC8701</span>, <time datetime="2020-01" class="refDate">January 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8701">https://www.rfc-editor.org/rfc/rfc8701</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9001">[RFC9001]</dt>
      <dd>
<span class="refAuthor">Thomson, M., Ed.</span> and <span class="refAuthor">S. Turner, Ed.</span>, <span class="refTitle">"Using TLS to Secure QUIC"</span>, <span class="seriesInfo">RFC 9001</span>, <span class="seriesInfo">DOI 10.17487/RFC9001</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9001">https://www.rfc-editor.org/rfc/rfc9001</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="test-vectors">
<section id="appendix-A">
      <h2 id="name-test-vectors">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<p id="appendix-A-1">This section includes test vectors for the HTTP authentication scheme specified
in this document. It consists of the following types of test vectors:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A-2">
<li id="appendix-A-2.1">Test vectors for the challenge and redemption protocols. Implementations can
use these test vectors for verifying code that builds and encodes
TokenChallenge structures, as well as code that produces a well-formed Token
bound to a TokenChallenge.<a href="#appendix-A-2.1" class="pilcrow">¶</a>
</li>
        <li id="appendix-A-2.2">Test vectors for the HTTP headers used for authentication. Implementations
can use these test vectors for validating whether they parse HTTP
authentication headers correctly to produce TokenChallenge structures and the
other associated parameters, such as the token-key and max-age values.<a href="#appendix-A-2.2" class="pilcrow">¶</a>
</li>
      </ol>
<div id="challenge-and-redemption-structure-test-vectors">
<section id="appendix-A.1">
        <h3 id="name-challenge-and-redemption-st">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-challenge-and-redemption-st" class="section-name selfRef">Challenge and Redemption Structure Test Vectors</a>
        </h3>
<p id="appendix-A.1-1">This section includes test vectors for the challenge and redemption
functionalities described in <a href="#challenge" class="auto internal xref">Section 2.1</a> and <a href="#redemption" class="auto internal xref">Section 2.2</a>. Each test vector
lists the following values:<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.1-2.1">token_type: The type of token issuance protocol, a value from
<a href="#token-types" class="auto internal xref">Section 5.2</a>. For these test vectors, token_type is 0x0002, corresponding
to the issuance protocol in <span>[<a href="#ISSUANCE" class="cite xref">ISSUANCE</a>]</span>.<a href="#appendix-A.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-2.2">issuer_name: The name of the issuer in the TokenChallenge structure,
represented as a hexadecimal string.<a href="#appendix-A.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-2.3">redemption_context: The redemption context in the TokenChallenge structure,
represented as a hexadecimal string.<a href="#appendix-A.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-2.4">origin_info: The origin info in the TokenChallenge structure, represented as
a hexadecimal string.<a href="#appendix-A.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-2.5">nonce: The nonce in the Token structure, represented as a hexadecimal string.<a href="#appendix-A.1-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-2.6">token_key: The public token-key, encoded based on the corresponding token
type, represented as a hexadecimal string.<a href="#appendix-A.1-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-A.1-2.7">token_authenticator_input: The values in the Token structure used to compute
the Token authenticator value, represented as a hexadecimal string.<a href="#appendix-A.1-2.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-A.1-3">Test vectors are provided for each of the following TokenChallenge
configurations:<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.1-4">
<li id="appendix-A.1-4.1">TokenChallenge with a single origin and non-empty redemption context<a href="#appendix-A.1-4.1" class="pilcrow">¶</a>
</li>
          <li id="appendix-A.1-4.2">TokenChallenge with a single origin and empty redemption context<a href="#appendix-A.1-4.2" class="pilcrow">¶</a>
</li>
          <li id="appendix-A.1-4.3">TokenChallenge with an empty origin and redemption context<a href="#appendix-A.1-4.3" class="pilcrow">¶</a>
</li>
          <li id="appendix-A.1-4.4">TokenChallenge with an empty origin and non-empty redemption context<a href="#appendix-A.1-4.4" class="pilcrow">¶</a>
</li>
          <li id="appendix-A.1-4.5">TokenChallenge with a multiple origins and non-empty redemption context<a href="#appendix-A.1-4.5" class="pilcrow">¶</a>
</li>
        </ol>
<p id="appendix-A.1-5">These test vectors are below.<a href="#appendix-A.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-6">
<pre>
// Test vector 1:
//   token_type(0002), issuer_name(issuer.example),
//   origin_info(origin.example), redemption_context(non-empty)
token_type: 0002
issuer_name: 6973737565722e6578616d706c65
redemption_context:
476ac2c935f458e9b2d7af32dacfbd22dd6023ef5887a789f1abe004e79bb5bb
origin_info: 6f726967696e2e6578616d706c65
nonce:
e01978182c469e5e026d66558ee186568614f235e41ef7e2378e6f202688abab
token_key_id:
ca572f8982a9ca248a3056186322d93ca147266121ddeb5632c07f1f71cd2708
token_authenticator_input: 0002e01978182c469e5e026d66558ee1865686
14f235e41ef7e2378e6f202688abab8e1d5518ec82964255526efd8f9db88205a
8ddd3ffb1db298fcc3ad36c42388fca572f8982a9ca248a3056186322d93ca147
266121ddeb5632c07f1f71cd2708

// Test vector 2:
//   token_type(0002), issuer_name(issuer.example),
//   origin_info(origin.example), redemption_context(empty)
token_type: 0002
issuer_name: 6973737565722e6578616d706c65
redemption_context:
origin_info: 6f726967696e2e6578616d706c65
nonce:
e01978182c469e5e026d66558ee186568614f235e41ef7e2378e6f202688abab
token_key_id:
ca572f8982a9ca248a3056186322d93ca147266121ddeb5632c07f1f71cd2708
token_authenticator_input: 0002e01978182c469e5e026d66558ee1865686
14f235e41ef7e2378e6f202688abab11e15c91a7c2ad02abd66645802373db1d8
23bea80f08d452541fb2b62b5898bca572f8982a9ca248a3056186322d93ca147
266121ddeb5632c07f1f71cd2708

// Test vector 3:
//   token_type(0002), issuer_name(issuer.example),
//   origin_info(), redemption_context(empty)
token_type: 0002
issuer_name: 6973737565722e6578616d706c65
redemption_context:
origin_info:
nonce:
e01978182c469e5e026d66558ee186568614f235e41ef7e2378e6f202688abab
token_key_id:
ca572f8982a9ca248a3056186322d93ca147266121ddeb5632c07f1f71cd2708
token_authenticator_input: 0002e01978182c469e5e026d66558ee1865686
14f235e41ef7e2378e6f202688ababb741ec1b6fd05f1e95f8982906aec161289
6d9ca97d53eef94ad3c9fe023f7a4ca572f8982a9ca248a3056186322d93ca147
266121ddeb5632c07f1f71cd2708

// Test vector 4:
//   token_type(0002), issuer_name(issuer.example),
//   origin_info(), redemption_context(non-empty)
token_type: 0002
issuer_name: 6973737565722e6578616d706c65
redemption_context:
476ac2c935f458e9b2d7af32dacfbd22dd6023ef5887a789f1abe004e79bb5bb
origin_info:
nonce:
e01978182c469e5e026d66558ee186568614f235e41ef7e2378e6f202688abab
token_key_id:
ca572f8982a9ca248a3056186322d93ca147266121ddeb5632c07f1f71cd2708
token_authenticator_input: 0002e01978182c469e5e026d66558ee1865686
14f235e41ef7e2378e6f202688ababb85fb5bc06edeb0e8e8bdb5b3bea8c4fa40
837c82e8bcaf5882c81e14817ea18ca572f8982a9ca248a3056186322d93ca147
266121ddeb5632c07f1f71cd2708

// Test vector 5:
//   token_type(0002), issuer_name(issuer.example),
//   origin_info(foo.example,bar.example),
//   redemption_context(non-empty)
token_type: 0002
issuer_name: 6973737565722e6578616d706c65
redemption_context:
476ac2c935f458e9b2d7af32dacfbd22dd6023ef5887a789f1abe004e79bb5bb
origin_info: 666f6f2e6578616d706c652c6261722e6578616d706c65
nonce:
e01978182c469e5e026d66558ee186568614f235e41ef7e2378e6f202688abab
token_key_id:
ca572f8982a9ca248a3056186322d93ca147266121ddeb5632c07f1f71cd2708
token_authenticator_input: 0002e01978182c469e5e026d66558ee1865686
14f235e41ef7e2378e6f202688ababa2a775866b6ae0f98944910c8f48728d8a2
735b9157762ddbf803f70e2e8ba3eca572f8982a9ca248a3056186322d93ca147
266121ddeb5632c07f1f71cd2708
</pre><a href="#appendix-A.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="http-header-test-vectors">
<section id="appendix-A.2">
        <h3 id="name-http-header-test-vectors">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-http-header-test-vectors" class="section-name selfRef">HTTP Header Test Vectors</a>
        </h3>
<p id="appendix-A.2-1">This section includes test vectors the contents of the HTTP authentication
headers. Each test vector consists of one or more challenges that comprise
a WWW-Authenticate header. For each challenge, the token-type, token-key,
max-age, and token-challenge parameters are listed. Each challenge also
includes an unknown (not specified) parameter that implementations are meant
to ignore.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">The parameters for each challenge are indexed by their position
in the WWW-Authentication challenge list. For example, token-key-0 denotes
the token-key parameter for the first challenge in the list, whereas
token-key-1 denotes the token-key for the second challenge in the list.<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<p id="appendix-A.2-3">The resulting wire-encoded WWW-Authentication header based on this
list of challenges is then listed at the end.<a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-4">
<pre>
token-type-0: 0x0002
token-key-0: 30820152303d06092a864886f70d01010a3030a00d300b060960864
8016503040202a11a301806092a864886f70d010108300b060960864801650304020
2a2030201300382010f003082010a0282010100cb1aed6b6a95f5b1ce013a4cfcab2
5b94b2e64a23034e4250a7eab43c0df3a8c12993af12b111908d4b471bec31d4b6c9
ad9cdda90612a2ee903523e6de5a224d6b02f09e5c374d0cfe01d8f529c500a78a2f
67908fa682b5a2b430c81eaf1af72d7b5e794fc98a3139276879757ce453b526ef9b
f6ceb99979b8423b90f4461a22af37aab0cf5733f7597abe44d31c732db68a181c6c
bbe607d8c0e52e0655fd9996dc584eca0be87afbcd78a337d17b1dba9e828bbd81e2
91317144e7ff89f55619709b096cbb9ea474cead264c2073fe49740c01f00e109106
066983d21e5f83f086e2e823c879cd43cef700d2a352a9babd612d03cad02db134b7
e225a5f0203010001
max-age-0: 10
token-challenge-0: 0002000e6973737565722e6578616d706c65208a3e83a33d9
8005d2f30bef419fa6bf4cd5c6005e36b1285bbb4ccd40fa4b383000e6f726967696
e2e6578616d706c65

WWW-Authenticate: PrivateToken challenge="AAIADmlzc3Vlci5leGFtcGxlII
o-g6M9mABdLzC-9Bn6a_TNXGAF42sShbu0zNQPpLODAA5vcmlnaW4uZXhhbXBsZQ==",
 token-key="MIIBUjA9BgkqhkiG9w0BAQowMKANMAsGCWCGSAFlAwQCAqEaMBgGCSqG
SIb3DQEBCDALBglghkgBZQMEAgKiAwIBMAOCAQ8AMIIBCgKCAQEAyxrta2qV9bHOATpM
_KsluUsuZKIwNOQlCn6rQ8DfOowSmTrxKxEZCNS0cb7DHUtsmtnN2pBhKi7pA1I-beWi
JNawLwnlw3TQz-Adj1KcUAp4ovZ5CPpoK1orQwyB6vGvcte155T8mKMTknaHl1fORTtS
bvm_bOuZl5uEI7kPRGGiKvN6qwz1cz91l6vkTTHHMttooYHGy75gfYwOUuBlX9mZbcWE
7KC-h6-814ozfRex26noKLvYHikTFxROf_ifVWGXCbCWy7nqR0zq0mTCBz_kl0DAHwDh
CRBgZpg9IeX4PwhuLoI8h5zUPO9wDSo1Kpur1hLQPK0C2xNLfiJaXwIDAQAB",unknow
nChallengeAttribute="ignore-me", max-age="10"

token-type-0: 0x0002
token-key-0: 30820152303d06092a864886f70d01010a3030a00d300b060960864
8016503040202a11a301806092a864886f70d010108300b060960864801650304020
2a2030201300382010f003082010a0282010100cb1aed6b6a95f5b1ce013a4cfcab2
5b94b2e64a23034e4250a7eab43c0df3a8c12993af12b111908d4b471bec31d4b6c9
ad9cdda90612a2ee903523e6de5a224d6b02f09e5c374d0cfe01d8f529c500a78a2f
67908fa682b5a2b430c81eaf1af72d7b5e794fc98a3139276879757ce453b526ef9b
f6ceb99979b8423b90f4461a22af37aab0cf5733f7597abe44d31c732db68a181c6c
bbe607d8c0e52e0655fd9996dc584eca0be87afbcd78a337d17b1dba9e828bbd81e2
91317144e7ff89f55619709b096cbb9ea474cead264c2073fe49740c01f00e109106
066983d21e5f83f086e2e823c879cd43cef700d2a352a9babd612d03cad02db134b7
e225a5f0203010001
max-age-0: 10
token-challenge-0: 0002000e6973737565722e6578616d706c65208a3e83a33d9
8005d2f30bef419fa6bf4cd5c6005e36b1285bbb4ccd40fa4b383000e6f726967696
e2e6578616d706c65
token-type-1: 0x0001
token-key-1: ebb1fed338310361c08d0c7576969671296e05e99a17d7926dfc28a
53fabd489fac0f82bca86249a668f3a5bfab374c9
max-age-1: 10
token-challenge-1: 0001000e6973737565722e6578616d706c65208a3e83a33d9
8005d2f30bef419fa6bf4cd5c6005e36b1285bbb4ccd40fa4b383000e6f726967696
e2e6578616d706c65

WWW-Authenticate: PrivateToken challenge="AAIADmlzc3Vlci5leGFtcGxlII
o-g6M9mABdLzC-9Bn6a_TNXGAF42sShbu0zNQPpLODAA5vcmlnaW4uZXhhbXBsZQ==",
 token-key="MIIBUjA9BgkqhkiG9w0BAQowMKANMAsGCWCGSAFlAwQCAqEaMBgGCSqG
SIb3DQEBCDALBglghkgBZQMEAgKiAwIBMAOCAQ8AMIIBCgKCAQEAyxrta2qV9bHOATpM
_KsluUsuZKIwNOQlCn6rQ8DfOowSmTrxKxEZCNS0cb7DHUtsmtnN2pBhKi7pA1I-beWi
JNawLwnlw3TQz-Adj1KcUAp4ovZ5CPpoK1orQwyB6vGvcte155T8mKMTknaHl1fORTtS
bvm_bOuZl5uEI7kPRGGiKvN6qwz1cz91l6vkTTHHMttooYHGy75gfYwOUuBlX9mZbcWE
7KC-h6-814ozfRex26noKLvYHikTFxROf_ifVWGXCbCWy7nqR0zq0mTCBz_kl0DAHwDh
CRBgZpg9IeX4PwhuLoI8h5zUPO9wDSo1Kpur1hLQPK0C2xNLfiJaXwIDAQAB",unknow
nChallengeAttribute="ignore-me", max-age="10", PrivateToken challeng
e="AAEADmlzc3Vlci5leGFtcGxlIIo-g6M9mABdLzC-9Bn6a_TNXGAF42sShbu0zNQPp
LODAA5vcmlnaW4uZXhhbXBsZQ==", token-key="67H-0zgxA2HAjQx1dpaWcSluBem
aF9eSbfwopT-r1In6wPgryoYkmmaPOlv6s3TJ",unknownChallengeAttribute="ig
nore-me", max-age="10"
</pre><a href="#appendix-A.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tommy Pauly</span></div>
<div dir="auto" class="left"><span class="org">Apple Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">One Apple Park Way</span></div>
<div dir="auto" class="left">
<span class="locality">Cupertino, California 95014</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tpauly@apple.com" class="email">tpauly@apple.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Steven Valdez</span></div>
<div dir="auto" class="left"><span class="org">Google LLC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:svaldez@chromium.org" class="email">svaldez@chromium.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christopher A. Wood</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:caw@heapingbits.net" class="email">caw@heapingbits.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
